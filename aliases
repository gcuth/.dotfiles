# basics
alias c="clear; ls"
alias vi="nvim"
alias e="$EDITOR"

# adding color to the usuals
alias l="ls -Glah"
alias ls="ls -G"
alias grep="grep --color=auto"
# alias diff='diff --color=auto'

# git
alias gs="git status -bs"
alias gd="git diff"
alias ga="git add"
alias gcs="git commit -S -m" # sign using -S by default!
alias gcams="git commit -a -S -m" # sign using -S by default!
alias gc="git commit -m"
alias gcam="git commit -a -m"
alias gp="git pull"
alias gpom="git push origin master"
# jump to top level of git repo
alias gt="cd \$(git rev-parse --show-toplevel)"
# Remove all traces of git from a folder
alias degit="find . -name '.git' -exec rm -rf {} \;"

# helpful extras
alias rg="grep -r '$*' ."
alias alert='notify-send --urgency=low -i "$([ $? = 0 ] && echo terminal || echo error)" "$(history|tail -n1|sed -e '\''s/^\s*[0-9]\+\s*//;s/[;&|]\s*alert$//'\'')"'

# Use ack to locate TOD* and FIXM* lines in current folder tree
alias todos='ack --nobreak --nocolor "(TODO|FIXME):"|sed -E "s/(.*:[[:digit:]]+):.*((TODO|FIXME):.*)/\2 :>> \1/"|grep -E --color=always ":>>.*:\d+"'

# those pesky permissions
alias ax='chmod a+x'

# Get current external IP
alias myip="curl icanhazip.com"

# List currently mounted usbs
function list_my_usbs() {
    lsblk | grep /media | grep -oP "sd[a-z]" | awk '{print "/dev/"$1}' | sort | uniq
}
alias myusbs="list_my_usbs"

# trim newlines
alias tn='tr -d "\n"'

alias tag="/home/g/.dotfiles/scripts/update_exist_tags add --tag "



# record
function default_record() {
    if [ `uname` = "Darwin" ]; then
        open '/Applications/Just Press Record.app'
    elif [ `uname -s` = "Linux" ]; then
        arecord -f cd -D default ~/Recordings/$(date +%Y-%m-%d-%H-%M-%S).wav
    fi
}
alias rr="default_record"

function record_zoom() {
    if [ `uname` = "Darwin" ]; then
        open '/Applications/Audio Hijack.app'
    elif [ `uname -s` = "Linux" ]; then
        arecord -f cd -D default ~/Recordings/$(date +%Y-%m-%d-%H-%M-%S).wav
    fi
}

function take_meeting_notes() {
    default_record
    toggl stop
    toggl start -o 'Social' -a 'meeting' "'$*'"
    $EDITOR ~/Documents/blog/_posts/meetings/$(date +%Y-%m-%d)-$(echo "'$*'" | sed "s/[A-Z]/\L&/g" | sed "s/ /-/g" | sed "s/'//g").md
}
alias mm="take_meeting_notes"

function start_journal_writing() {
    toggl stop
    toggl start -o 'Blog' -a 'writing' "Write morning pages"
    $EDITOR ~/Documents/blog/_posts/journals/$(date +%Y-%m-%d).md
    for TASKID in `todoist list | grep "Write morning pages" | sed 's/ .*//g'`; do
        todoist close $TASKID;
    done
    toggl stop
}
alias jj="start_journal_writing"

function write_a_note() {
    ~/.dotfiles/scripts/addtozotero.py `pbpaste`
    $EDITOR `pbpaste | ~/.dotfiles/scripts/note | tr -d '\n'`
    ~/.dotfiles/scripts/as_audio.py `pbpaste`
}
alias nn="write_a_note"


function fuzzy_find_and_edit() {
    $EDITOR `fzf --preview="cat {}" --preview-window=right:70%:wrap`
}
alias fuz="fuzzy_find_and_edit"

# Open the most recently edited thesis file
function start_thesis_writing() {
    toggl stop
    toggl start -o 'Thesis' -a 'thesis, study, writing' "Write `ls -At ~/Documents/thesis/chapters | head -n 1 | sed 's/\..*//g'` chapter."
    $EDITOR ~/Documents/thesis/chapters/`ls -At ~/Documents/thesis/chapters | head -n 1`
}
alias thesis="start_thesis_writing"

# cookie cut a (python) Data Science project
alias ccds="cookiecutter https://github.com/drivendata/cookiecutter-data-science"

# codewars kata
function start_a_kata() {
    # LANGUAGE=`bb -i '(rand-nth ["julia" "clojure" "r" "python"])' | sed 's/"//g' | tr -d "\n"`
    open "https://www.codewars.com/trainer/clojure" | xdg-open "https://www.codewars.com/trainer/clojure"
    if [ `toggl now | grep "kata" | wc -l` -gt 0 ]; then
        echo "Suitable task already running!"
    else
        toggl start -o 'Tekke' -a 'codewars, coding, clojure' "Complete a codewars kata";
        echo "Started a toggl entry for a clojure kata on codewars";
    fi
    # if [ `todoist list --filter '(today|overdue)' | grep "kata" | wc -l` -gt 0 ]; then
    #     echo "Suitable task already in todoist!"
    # else
    #     todoist add --priority 1 --date "today" --project-name "Tekke" "Complete a codewars kata";
    #     echo "Added a codewars kata task to todoist";
    #     todoist sync;
    # fi
}
alias kata="start_a_kata"

# todoist
alias tc="todoist close"
alias tl="todoist list --filter 'today|overdue'"

# Uni Convenience
alias anuc="globalprotect connect --portal staff-access.anu.edu.au"
alias anud="globalprotect disconnect"
alias anus="globalprotect show --status"

# ProtonVPN Convenience
alias pvc="protonvpn-cli c -r"
alias pvcr="protonvpn-cli c -r"
alias pvcf="protonvpn-cli c -f"
alias pvd="protonvpn-cli d"
alias pvs="protonvpn-cli s"

# generate loading screen tip emails from the task list
function send_loading_screen_tips() {
    for EMAIL in `todoist list | grep "Loading Screen Tip to" | sed 's/.*Loading Screen Tip to //g'`; do
        MAILTO=`~/.dotfiles/scripts/mail_loading_screen_tip $EMAIL`;
        open $MAILTO | xdg-open $MAILTO;
    done
    for TASKID in `todoist list | grep "Loading Screen Tip to" | sed 's/ .*//g'`; do
        todoist close $TASKID;
    done
}
alias loadingscreentips="send_loading_screen_tips"
