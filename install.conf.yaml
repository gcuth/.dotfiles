# DEFAULT BEHAVIOURS
- defaults:
    link:
      create: true
      relink: true

# CLEAN ON START
- clean: ['~', '~/.local/bin/', '~/Library/Application Support/Code/User/snippets/']

# CREATE THE BASIC (NEEDED) DIRS
- create:
    - ~/Developer/

# LINK VERY BASIC GLOBAL SETTINGS FILES, SNIPPETS, & SCRIPTS:
- link:
    ~/.zshrc:
      path: zshrc
      create: true
      relink: true
      force: true
    ~/.stack/config.yaml:
      path: stack/config.yaml
    ~/.zprofile:
      path: zprofile
    ~/.profile:
      path: profile
    ~/.RProfile:
      path: RProfile
    ~/.aliases:
      path: aliases
    ~/.gitignore:
      path: gitignore
    ~/.gitconfig:
      path: gitconfig
    ~/.config/starship.toml:
      path: starship.toml
    ~/.tmux.conf:
      path: tmux.conf
    ~/.local/bin/:
      path: scripts/**
      glob: true
      create: true
    ~/.lein/profiles.clj:
      path: lein/profiles.clj
    ~/Library/Application Support/Code/User/settings.json:
      path: vscode/settings.json
      create: true
      relink: true
      force: true
    ~/Library/Application Support/Code/User/snippets/:
      path: snippets/**
      glob: true
      create: true

# BREW:
- shell:
  - [ test -e `which brew` || /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" ]
- shell:
  - brew update && brew upgrade
- brew: 
  - python
  - nvm
  - neovim
  - pandoc
  - java
  - leiningen
  - git
  - gpg
  - fzf
  - jq
  - gh
  - ffmpeg
  - rclone
  - tmux
  - rust
  - borkdude/brew/babashka
  - ripgrep
  - gdu
  - discord
  - docker
  - starship
  - keybase
  - obsidian
  - sqlcipher
- tap:
  - homebrew/cask-fonts
- brew:
  - font-fira-code
  - font-hack-nerd-font
- tap:
  - homebrew/cask-versions
- brew:
  - iterm2-beta
- shell:
  - [ test -e `which toggl` || pip install togglCli ]
- shell:
  - [ test -e /Applications/Anki.app || open "https://apps.ankiweb.net" ]


# CLONE THESIS & BLOG IF NOT ALREADY PRESENT (AND LINK HOOKS)
- shell:
  - if [ ! -d "/Users/g/Documents/thesis" ]; then git clone git@github.com:gcuth/phd_thesis.git ~/Documents/thesis; fi
  - if [ ! -d "/Users/g/Documents/blog" ]; then git clone git@github.com:gcuth/gcuth.github.io.git ~/Documents/blog; fi
- link:
    ~/Documents/blog/.git/hooks/pre-commit:
      path: hooks/blog-pre-commit
- link:
    ~/Documents/thesis/.git/hooks/pre-commit:
      path: hooks/thesis-pre-commit
- link:
    ~/Documents/thesis/.git/hooks/post-commit:
      path: hooks/thesis-post-commit


# IF VSCODE EXISTS, INSTALL BASIC EXTENSIONS FROM FILE
- shell:
  - [ test -e `which code` && cat /Users/g/.dotfiles/vscode/extensions.txt | xargs -n 1 code --install-extension ]

# SETUP CRON JOBS:
- crontab:
  # commit any changes to a thesis chapter in the last five minutes automatically
  - cron: "*/5 * * * *"
    command: /opt/homebrew/bin/git -C /Users/g/Documents/thesis add ./chapters; /opt/homebrew/bin/git -C /Users/g/Documents/thesis/ commit -m 'Auto-commit'; /opt/homebrew/bin/git -C /Users/g/Documents/thesis push origin master >/dev/null 2>&1
  # commit any blog changes in the last ten minutes automatically
  - cron: "*/10 * * * *"
    command: /opt/homebrew/bin/git -C /Users/g/Documents/blog add .; /opt/homebrew/bin/git -C /Users/g/Documents/blog/ commit -m 'Auto-commit'; /opt/homebrew/bin/git -C /Users/g/Documents/blog push origin master >/dev/null 2>&1
  # every minute, log the currently playing song (if any) to a csv file
  - cron: "* * * * *"
    command: osascript /Users/g/.dotfiles/applescripts/tunes.js >> ~/Library/Mobile\ Documents/iCloud\~is\~workflow\~my\~workflows/Documents/Logs/Consumption/Music/playing.csv
  # Run a 'check in' shortcut every five minutes (prompting to log activity, or exercise, or mood, or whatever)
  - cron: "*/5 * * * *"
    command: shortcuts run "Every Five Minutes"
  # run a shortcut to clean up the desktop (move screenshots to photos etc)
  - cron: "45 9-17 * * *"
    command: shortcuts run "Clean Up Desktop"
  # run a shortcut to log the email inbox
  - cron: "59 * * * *"
    command: shortcuts run "Save Email Report"
  # save a list of the current vscode extensions to a file for easy reinstallation
  - cron: "0 9 * * *"
    command: /Users/g/.dotfiles/scripts/list_vscode_extensions.sh