- defaults:
    link:
      create: true
      relink: true

- clean: ['~', '~/.local/bin/', '~/Library/Application Support/Code/User/snippets/']

# CREATE THE BASIC (NEEDED) DIRS
- create:
    - ~/Developer/

# VERY BASIC GLOBAL SETTINGS:
- link:
    ~/.bashrc:
      path: bashrc
      create: true
      relink: true
      force: true
    ~/.zshrc:
      path: zshrc
      create: true
      relink: true
      force: true
    ~/.stack/config.yaml:
      path: stack/config.yaml
    ~/.zprofile:
      path: zprofile
    ~/.RProfile:
      path: RProfile
    ~/.aliases:
      path: aliases
    ~/.gitignore:
      path: gitignore
    ~/.gitconfig:
      path: gitconfig
    ~/.config/starship.toml:
      path: starship.toml
    ~/.tmux.conf:
      path: tmux.conf
    ~/.newsboat/urls:
      path: newsboat/urls
    ~/.newsboat/config:
      path: newsboat/newsboatrc
    ~/.local/bin/:
      path: scripts/**
      glob: true
      create: true
    ~/.lein/profiles.clj:
      path: lein/profiles.clj
    ~/Library/Application Support/Code/User/settings.json:
      path: vscode/settings.json
      create: true
      relink: true
      force: true
    ~/Library/Application Support/Code/User/snippets/:
      path: snippets/**
      glob: true
      create: true

# BREW:
- shell:
  - [ test -e `which brew` || /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)" ]
- shell:
  - brew update && brew upgrade
- brew: 
  - python
  - neovim
  - pandoc
  - java
  - julia
  - leiningen
  - newsboat
  - git
  - gpg
  - fzf
  - jq
  - gh
  - chrome-cli
  - hledger
  - ffmpeg
  - youtube-dl
  - rclone
  - tmux
  - dark-mode
  - haskell-stack
  - toot
  - rust
  - borkdude/brew/babashka
  - ripgrep
  - jesseduffield/lazygit/lazygit
  - gdu
  - bottom
  - iterm2
  - discord
  - docker
- tap:
  - homebrew/cask-fonts
- brew:
  - font-fira-code
  - font-hack-nerd-font
- brew:
  - hashicorp/tap/terraform
- shell:
  - [ test -e `which toggl` || pip install togglCli ]
- shell:
  - [ test -e /Applications/Anki.app || open "https://apps.ankiweb.net" ]


# if you don't already have them, you probably want them:
- shell:
  - if [ ! -d "/Users/g/Documents/thesis" ]; then git clone git@github.com:gcuth/phd_thesis.git ~/Documents/thesis; fi
  - if [ ! -d "/Users/g/Documents/blog" ]; then git clone git@github.com:gcuth/gcuth.github.io.git ~/Documents/blog; fi

# use cargo to install some stuff!
- shell:
  - cargo install tree-sitter-cli

# # link hooks:
- link:
    ~/Documents/blog/.git/hooks/pre-commit:
      path: hooks/blog-pre-commit

# install starship for enlivening the prompt a little
- shell:
    - curl -fsSL https://starship.rs/install.sh -o ./starship.sh; bash ./starship.sh -y; rm ./starship.sh

# if VSCode exists, install some extensions from a file
- shell:
  - [ test -e `which code` && cat /Users/g/.dotfiles/vscode/extensions.txt | xargs -n 1 code --install-extension ]

# cron setup
- crontab:
  - cron: 0,5,10,15,20,25,30,35,40,45,50,55 * * * *
    command: /opt/homebrew/bin/git -C /Users/g/Documents/thesis add .; /opt/homebrew/bin/git -C /Users/g/Documents/thesis/ commit -m 'Auto-commit' >/dev/null 2>&1
  - cron: 0,10,20,30,40,50 * * * *
    command: /opt/homebrew/bin/git -C /Users/g/Documents/blog add .; /opt/homebrew/bin/git -C /Users/g/Documents/blog/ commit -m 'Auto-commit' >/dev/null 2>&1
  - cron: 1 * * * *
    command: /opt/homebrew/bin/git -C /Users/g/Documents/thesis push origin master >/dev/null 2>&1
  - cron: 1 * * * *
    command: /opt/homebrew/bin/git -C /Users/g/Documents/blog push origin master >/dev/null 2>&1
  - cron: 5,35 * * * *
    command: /opt/homebrew/bin/toggl ls --fields 'id,workspace,description,project,task,billable,start,stop,duration,tags' >> /Users/g/Documents/blog/data/logs/toggl; cp /Users/g/Documents/blog/data/logs/toggl /Users/g/Documents/blog/data/logs/old_toggl; cat /Users/g/Documents/blog/data/logs/old_toggl | sort -u > /Users/g/Documents/blog/data/logs/toggl; rm /Users/g/Documents/blog/data/logs/old_toggl
  - cron: 5,35 * * * *
    command: /opt/homebrew/bin/python3 /Users/g/Documents/blog/bin/crypto.py >> /Users/g/Documents/blog/data/logs/crypto.csv
  - cron: 0,5,10,15,20,25,30,35,40,45,50,55 * * * *
    command: for TAB in `chrome-cli list tabs | grep "YouTube" | sed 's/\].*//g' | sed 's/\[//g'`; do chrome-cli close -t $TAB; done >/dev/null 2>&1
  - cron: 22 * * * *
    command: /opt/homebrew/bin/bb ~/Documents/blog/bin/colophon.bb >/dev/null 2>&1
  - cron: 0,12,24,36,48 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/log_anki_progress.py >/dev/null
  - cron: 0,12,24,36,48 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/log_email_inbox.py >/dev/null
  - cron: 0,12,24,36,48 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/log_network_status.py >/dev/null
  - cron: 14 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/extract_run_log.py >/dev/null
  - cron: 14 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/extract_finance_logs.py >/dev/null
  - cron: 14 * * * *
    command: /opt/homebrew/bin/python3 Users/g/Documents/blog/bin/extract_shortcut_health_logs.py >/dev/null
  - cron: "* * * * *"
    command: osascript /Users/g/.dotfiles/applescripts/tunes.js >> /Users/g/Documents/blog/data/logs/music/playing.csv
  - cron: "*/5 * * * *"
    command: shortcuts run "Prompt for Current Activity"
  - cron: "0 9 * * *"
    command: /Users/g/.dotfiles/scripts/list_vscode_extensions.sh

- shell:
  command: ['curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.1/install.sh | bash']
